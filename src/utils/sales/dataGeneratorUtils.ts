
/**
 * 데이터 변환을 위한 유틸리티 함수들
 */

import { parseNumericValue } from './dataTransformers';

/**
 * 하드코딩된 국가별 모델 데이터 생성
 * @param country 국가명
 * @returns 고정된 국가 모델 데이터
 */
export const getFixedCountryData = (country: string): any[][] | null => {
  // 국가별 하드코딩된 데이터 맵
  const countryDataMap: Record<string, any[][]> = {
    "영국": [
      // 모델1 데이터 (12개월 * 5개 카테고리 * 2(QTY,AMT) + 12개 비고)
      [
        // 1월 데이터
        "45", "394", "68", "723", "32", "287", "41", "389", "57", "569", "",
        // 2월 데이터
        "52", "467", "73", "754", "38", "326", "48", "432", "62", "617", "",
        // 3월 데이터
        "59", "542", "79", "813", "45", "387", "53", "481", "68", "672", "",
        // 4월 데이터
        "47", "417", "65", "689", "35", "312", "44", "402", "59", "583", "",
        // 5월 데이터
        "51", "455", "71", "736", "41", "359", "49", "442", "63", "629", "",
        // 6월 데이터
        "56", "509", "76", "782", "48", "418", "54", "491", "67", "658", "",
        // 7월 데이터
        "43", "389", "62", "647", "33", "294", "42", "375", "58", "574", "",
        // 8월 데이터
        "50", "442", "69", "712", "39", "347", "47", "428", "61", "603", "",
        // 9월 데이터
        "57", "518", "77", "791", "46", "402", "52", "467", "66", "649", "",
        // 10월 데이터
        "46", "403", "64", "672", "36", "321", "45", "415", "60", "592", "",
        // 11월 데이터
        "53", "472", "74", "758", "42", "368", "50", "452", "64", "635", "",
        // 12월 데이터
        "58", "531", "78", "803", "49", "429", "55", "503", "69", "680", ""
      ],
      // 모델2 데이터 (12개월 * 5개 카테고리 * 2(QTY,AMT) + 12개 비고)
      [
        // 1월 데이터
        "55", "636", "76", "801", "36", "476", "47", "578", "69", "712", "",
        // 2월 데이터
        "61", "683", "82", "859", "43", "526", "53", "636", "73", "749", "",
        // 3월 데이터
        "67", "739", "89", "934", "51", "591", "59", "697", "77", "789", "",
        // 4월 데이터
        "57", "653", "77", "813", "39", "496", "49", "592", "71", "733", "",
        // 5월 데이터
        "62", "691", "83", "871", "46", "553", "55", "653", "74", "756", "",
        // 6월 데이터
        "68", "746", "90", "942", "53", "613", "61", "713", "78", "793", "",
        // 7월 데이터
        "54", "629", "75", "792", "37", "482", "48", "584", "70", "721", "",
        // 8월 데이터
        "60", "676", "81", "849", "44", "539", "54", "642", "72", "742", "",
        // 9월 데이터
        "66", "731", "88", "927", "52", "604", "60", "703", "76", "784", "",
        // 10월 데이터
        "56", "647", "76", "802", "38", "491", "48", "586", "70", "726", "",
        // 11월 데이터
        "63", "699", "84", "878", "47", "561", "56", "659", "75", "764", "",
        // 12월 데이터
        "69", "752", "91", "949", "54", "619", "62", "718", "79", "798", ""
      ]
    ],
    "프랑스": [
      // 모델1 데이터
      [
        // 1월 데이터
        "42", "324", "63", "613", "29", "237", "38", "319", "52", "489", "",
        // 2월 데이터
        "47", "377", "67", "654", "33", "276", "43", "362", "55", "527", "",
        // 3월 데이터
        "53", "432", "72", "713", "39", "317", "47", "411", "59", "572", "",
        // 4월 데이터
        "43", "337", "64", "629", "30", "252", "39", "329", "53", "502", "",
        // 5월 데이터
        "48", "385", "68", "666", "34", "289", "44", "371", "56", "536", "",
        // 6월 데이터
        "54", "439", "73", "722", "40", "327", "48", "419", "60", "579", "",
        // 7월 데이터
        "41", "319", "62", "603", "28", "231", "37", "312", "51", "481", "",
        // 8월 데이터
        "46", "372", "66", "646", "32", "271", "42", "356", "54", "521", "",
        // 9월 데이터
        "52", "429", "71", "707", "38", "313", "46", "407", "58", "569", "",
        // 10월 데이터
        "42", "333", "63", "622", "29", "248", "38", "324", "52", "498", "",
        // 11월 데이터
        "49", "392", "69", "672", "35", "294", "45", "378", "57", "542", "",
        // 12월 데이터
        "55", "444", "74", "728", "41", "331", "49", "425", "61", "584", ""
      ],
      // 모델2 데이터
      [
        // 1월 데이터
        "51", "536", "72", "701", "33", "376", "44", "478", "64", "612", "",
        // 2월 데이터
        "56", "583", "77", "759", "39", "426", "49", "536", "67", "649", "",
        // 3월 데이터
        "62", "639", "83", "834", "47", "491", "54", "597", "71", "689", "",
        // 4월 데이터
        "52", "553", "73", "713", "34", "396", "45", "492", "65", "633", "",
        // 5월 데이터
        "57", "591", "78", "771", "40", "453", "50", "553", "68", "656", "",
        // 6월 데이터
        "63", "646", "84", "842", "48", "513", "55", "613", "72", "693", "",
        // 7월 데이터
        "50", "529", "71", "692", "32", "382", "43", "484", "63", "621", "",
        // 8월 데이터
        "55", "576", "76", "749", "38", "439", "48", "542", "66", "642", "",
        // 9월 데이터
        "61", "631", "82", "827", "46", "504", "53", "603", "70", "684", "",
        // 10월 데이터
        "51", "547", "72", "702", "33", "391", "44", "486", "64", "626", "",
        // 11월 데이터
        "58", "599", "79", "778", "41", "461", "51", "559", "69", "664", "",
        // 12월 데이터
        "64", "652", "85", "849", "49", "519", "56", "618", "73", "698", ""
      ]
    ],
    "독일": [
      // 모델1 데이터
      [
        // 1월 데이터
        "48", "444", "69", "703", "35", "337", "44", "419", "59", "589", "",
        // 2월 데이터
        "54", "497", "74", "754", "40", "376", "49", "462", "63", "627", "",
        // 3월 데이터
        "61", "552", "80", "813", "47", "417", "54", "511", "68", "672", "",
        // 4월 데이터
        "49", "457", "70", "719", "36", "352", "45", "429", "60", "602", "",
        // 5월 데이터
        "55", "505", "75", "766", "41", "389", "50", "471", "64", "636", "",
        // 6월 데이터
        "62", "559", "81", "822", "48", "427", "55", "519", "69", "679", "",
        // 7월 데이터
        "47", "439", "68", "693", "34", "331", "43", "412", "58", "581", "",
        // 8월 데이터
        "53", "492", "73", "746", "39", "371", "48", "456", "62", "621", "",
        // 9월 데이터
        "60", "549", "79", "807", "46", "413", "53", "507", "67", "669", "",
        // 10월 데이터
        "48", "453", "69", "712", "35", "348", "44", "424", "59", "598", "",
        // 11월 데이터
        "56", "512", "76", "772", "42", "394", "51", "478", "65", "642", "",
        // 12월 데이터
        "63", "564", "82", "828", "49", "431", "56", "525", "70", "684", ""
      ],
      // 모델2 데이터
      [
        // 1월 데이터
        "58", "656", "79", "821", "41", "496", "51", "598", "72", "732", "",
        // 2월 데이터
        "65", "703", "86", "879", "48", "546", "57", "656", "77", "769", "",
        // 3월 데이터
        "72", "759", "93", "954", "56", "611", "64", "717", "82", "809", "",
        // 4월 데이터
        "59", "673", "80", "833", "42", "516", "52", "612", "73", "753", "",
        // 5월 데이터
        "66", "711", "87", "891", "49", "573", "58", "673", "78", "776", "",
        // 6월 데이터
        "73", "766", "94", "962", "57", "633", "65", "733", "83", "813", "",
        // 7월 데이터
        "57", "649", "78", "812", "40", "502", "50", "604", "71", "741", "",
        // 8월 데이터
        "64", "696", "85", "869", "47", "559", "56", "662", "76", "762", "",
        // 9월 데이터
        "71", "751", "92", "947", "55", "624", "63", "723", "81", "804", "",
        // 10월 데이터
        "58", "667", "79", "822", "41", "511", "51", "606", "72", "746", "",
        // 11월 데이터
        "67", "719", "88", "898", "50", "581", "59", "679", "79", "784", "",
        // 12월 데이터
        "74", "772", "95", "969", "58", "639", "66", "738", "84", "818", ""
      ]
    ],
    "미국": [
      // 모델1 데이터
      [
        // 1월 데이터
        "65", "654", "81", "873", "45", "527", "58", "619", "72", "789", "",
        // 2월 데이터
        "71", "707", "87", "924", "51", "566", "64", "662", "78", "827", "",
        // 3월 데이터
        "78", "762", "94", "983", "59", "607", "71", "711", "84", "872", "",
        // 4월 데이터
        "66", "667", "82", "889", "46", "542", "59", "629", "73", "802", "",
        // 5월 데이터
        "72", "715", "88", "936", "52", "579", "65", "671", "79", "836", "",
        // 6월 데이터
        "79", "769", "95", "992", "60", "617", "72", "719", "85", "879", "",
        // 7월 데이터
        "64", "649", "80", "863", "44", "521", "57", "612", "71", "781", "",
        // 8월 데이터
        "70", "702", "86", "916", "50", "561", "63", "656", "77", "821", "",
        // 9월 데이터
        "77", "759", "93", "977", "58", "603", "70", "707", "83", "869", "",
        // 10월 데이터
        "65", "663", "81", "882", "45", "538", "58", "624", "72", "798", "",
        // 11월 데이터
        "73", "722", "89", "942", "53", "584", "66", "678", "80", "842", "",
        // 12월 데이터
        "80", "774", "96", "998", "61", "621", "73", "725", "86", "884", ""
      ],
      // 모델2 데이터
      [
        // 1월 데이터
        "75", "856", "92", "991", "51", "676", "63", "798", "86", "932", "",
        // 2월 데이터
        "82", "903", "99", "1,049", "59", "726", "70", "856", "92", "969", "",
        // 3월 데이터
        "89", "959", "106", "1,124", "67", "791", "78", "917", "98", "1,009", "",
        // 4월 데이터
        "76", "873", "93", "1,003", "52", "696", "64", "812", "87", "953", "",
        // 5월 데이터
        "83", "911", "100", "1,061", "60", "753", "71", "873", "93", "976", "",
        // 6월 데이터
        "90", "966", "107", "1,132", "68", "813", "79", "933", "99", "1,013", "",
        // 7월 데이터
        "74", "849", "91", "982", "50", "682", "62", "804", "85", "941", "",
        // 8월 데이터
        "81", "896", "98", "1,039", "58", "739", "69", "862", "91", "962", "",
        // 9월 데이터
        "88", "951", "105", "1,117", "66", "804", "77", "923", "97", "1,004", "",
        // 10월 데이터
        "75", "867", "92", "992", "51", "691", "63", "806", "86", "946", "",
        // 11월 데이터
        "84", "919", "101", "1,068", "61", "761", "72", "879", "94", "984", "",
        // 12월 데이터
        "91", "972", "108", "1,139", "69", "819", "80", "938", "100", "1,018", ""
      ]
    ],
    "캐나다": [
      // 모델1 데이터
      [
        // 1월 데이터
        "60", "594", "76", "813", "40", "467", "53", "559", "67", "729", "",
        // 2월 데이터
        "66", "647", "82", "864", "46", "506", "59", "602", "73", "767", "",
        // 3월 데이터
        "73", "702", "89", "923", "54", "547", "66", "651", "79", "812", "",
        // 4월 데이터
        "61", "607", "77", "829", "41", "482", "54", "569", "68", "742", "",
        // 5월 데이터
        "67", "655", "83", "876", "47", "519", "60", "611", "74", "776", "",
        // 6월 데이터
        "74", "709", "90", "932", "55", "557", "67", "659", "80", "819", "",
        // 7월 데이터
        "59", "589", "75", "803", "39", "461", "52", "552", "66", "721", "",
        // 8월 데이터
        "65", "642", "81", "856", "45", "501", "58", "596", "72", "761", "",
        // 9월 데이터
        "72", "699", "88", "917", "53", "543", "65", "647", "78", "809", "",
        // 10월 데이터
        "60", "603", "76", "822", "40", "478", "53", "564", "67", "738", "",
        // 11월 데이터
        "68", "662", "84", "882", "48", "524", "61", "618", "75", "782", "",
        // 12월 데이터
        "75", "714", "91", "938", "56", "561", "68", "665", "81", "824", ""
      ],
      // 모델2 데이터
      [
        // 1월 데이터
        "70", "796", "87", "931", "46", "616", "58", "738", "81", "872", "",
        // 2월 데이터
        "77", "843", "94", "989", "54", "666", "65", "796", "87", "909", "",
        // 3월 데이터
        "84", "899", "101", "1,064", "62", "731", "73", "857", "93", "949", "",
        // 4월 데이터
        "71", "813", "88", "943", "47", "636", "59", "752", "82", "893", "",
        // 5월 데이터
        "78", "851", "95", "1,001", "55", "693", "66", "813", "88", "916", "",
        // 6월 데이터
        "85", "906", "102", "1,072", "63", "753", "74", "873", "94", "953", "",
        // 7월 데이터
        "69", "789", "86", "922", "45", "622", "57", "744", "80", "881", "",
        // 8월 데이터
        "76", "836", "93", "979", "53", "679", "64", "802", "86", "902", "",
        // 9월 데이터
        "83", "891", "100", "1,057", "61", "744", "72", "863", "92", "944", "",
        // 10월 데이터
        "70", "807", "87", "932", "46", "631", "58", "746", "81", "886", "",
        // 11월 데이터
        "79", "859", "96", "1,008", "56", "701", "67", "819", "89", "924", "",
        // 12월 데이터
        "86", "912", "103", "1,079", "64", "759", "75", "878", "95", "958", ""
      ]
    ],
    "일본": [
      // 모델1 데이터
      [
        // 1월 데이터
        "58", "524", "74", "743", "38", "427", "51", "519", "65", "689", "",
        // 2월 데이터
        "64", "577", "80", "794", "44", "476", "57", "562", "71", "727", "",
        // 3월 데이터
        "71", "632", "87", "853", "52", "537", "64", "611", "77", "772", "",
        // 4월 데이터
        "59", "537", "75", "759", "39", "442", "52", "529", "66", "702", "",
        // 5월 데이터
        "65", "585", "81", "806", "45", "479", "58", "571", "72", "736", "",
        // 6월 데이터
        "72", "639", "88", "862", "53", "527", "65", "619", "78", "779", "",
        // 7월 데이터
        "57", "519", "73", "733", "37", "421", "50", "512", "64", "681", "",
        // 8월 데이터
        "63", "572", "79", "786", "43", "471", "56", "556", "70", "721", "",
        // 9월 데이터
        "70", "629", "86", "847", "51", "533", "63", "607", "76", "769", "",
        // 10월 데이터
        "58", "533", "74", "752", "38", "438", "51", "524", "65", "698", "",
        // 11월 데이터
        "66", "592", "82", "812", "46", "484", "59", "578", "73", "742", "",
        // 12월 데이터
        "73", "644", "89", "868", "54", "531", "66", "625", "79", "784", ""
      ],
      // 모델2 데이터
      [
        // 1월 데이터
        "68", "726", "85", "861", "44", "596", "57", "718", "79", "822", "",
        // 2월 데이터
        "75", "773", "92", "919", "52", "646", "64", "776", "85", "859", "",
        // 3월 데이터
        "82", "829", "99", "994", "60", "711", "72", "837", "91", "899", "",
        // 4월 데이터
        "69", "743", "86", "873", "45", "616", "58", "732", "80", "843", "",
        // 5월 데이터
        "76", "781", "93", "931", "53", "673", "65", "793", "86", "866", "",
        // 6월 데이터
        "83", "836", "100", "1,002", "61", "733", "73", "853", "92", "903", "",
        // 7월 데이터
        "67", "719", "84", "852", "43", "592", "56", "724", "78", "831", "",
        // 8월 데이터
        "74", "766", "91", "909", "51", "659", "63", "782", "84", "852", "",
        // 9월 데이터
        "81", "821", "98", "987", "59", "724", "71", "843", "90", "894", "",
        // 10월 데이터
        "68", "737", "85", "862", "44", "611", "57", "726", "79", "836", "",
        // 11월 데이터
        "77", "789", "94", "938", "54", "681", "66", "799", "87", "874", "",
        // 12월 데이터
        "84", "842", "101", "1,009", "62", "739", "74", "858", "93", "908", ""
      ]
    ],
    "중국": [
      // 모델1 데이터
      [
        // 1월 데이터
        "72", "754", "88", "933", "52", "627", "65", "719", "79", "879", "",
        // 2월 데이터
        "79", "807", "94", "984", "59", "666", "72", "762", "85", "917", "",
        // 3월 데이터
        "86", "862", "101", "1,043", "67", "707", "79", "811", "92", "962", "",
        // 4월 데이터
        "73", "767", "89", "949", "53", "642", "66", "729", "80", "892", "",
        // 5월 데이터
        "80", "815", "95", "996", "60", "679", "73", "771", "86", "926", "",
        // 6월 데이터
        "87", "869", "102", "1,052", "68", "717", "80", "819", "93", "969", "",
        // 7월 데이터
        "71", "749", "87", "923", "51", "621", "64", "712", "78", "871", "",
        // 8월 데이터
        "78", "802", "93", "976", "58", "661", "71", "756", "84", "911", "",
        // 9월 데이터
        "85", "859", "100", "1,037", "66", "703", "78", "807", "91", "959", "",
        // 10월 데이터
        "72", "763", "88", "942", "52", "639", "65", "724", "79", "888", "",
        // 11월 데이터
        "81", "822", "96", "1,002", "61", "684", "74", "782", "87", "932", "",
        // 12월 데이터
        "88", "874", "103", "1,058", "69", "721", "81", "825", "94", "974", ""
      ],
      // 모델2 데이터
      [
        // 1월 데이터
        "82", "956", "99", "1,061", "58", "786", "70", "898", "93", "1,022", "",
        // 2월 데이터
        "89", "1,003", "106", "1,119", "66", "836", "77", "956", "99", "1,059", "",
        // 3월 데이터
        "96", "1,059", "113", "1,184", "74", "891", "85", "1,017", "105", "1,099", "",
        // 4월 데이터
        "83", "973", "100", "1,073", "59", "796", "71", "912", "94", "1,043", "",
        // 5월 데이터
        "90", "1,011", "107", "1,131", "67", "853", "78", "973", "100", "1,066", "",
        // 6월 데이터
        "97", "1,066", "114", "1,192", "75", "903", "86", "1,033", "106", "1,103", "",
        // 7월 데이터
        "81", "949", "98", "1,052", "57", "782", "69", "904", "92", "1,031", "",
        // 8월 데이터
        "88", "996", "105", "1,109", "65", "839", "76", "962", "98", "1,052", "",
        // 9월 데이터
        "95", "1,051", "112", "1,177", "73", "894", "84", "1,023", "104", "1,094", "",
        // 10월 데이터
        "82", "967", "99", "1,062", "58", "791", "70", "906", "93", "1,036", "",
        // 11월 데이터
        "91", "1,019", "108", "1,138", "68", "861", "79", "979", "101", "1,074", "",
        // 12월 데이터
        "98", "1,072", "115", "1,199", "76", "909", "87", "1,038", "107", "1,108", ""
      ]
    ]
  };
  
  return countryDataMap[country] || null;
};

/**
 * 랜덤 데이터 생성 함수 (하드코딩된 데이터 사용이 없을 때 대비)
 * @returns 생성된 qty, amt 객체
 */
export const generateRandomData = () => {
  const qty = Math.floor(Math.random() * 90) + 10; // 10-99 범위의 2자리 숫자
  const amt = Math.floor(Math.random() * 900) + 100; // 100-999 범위의 3자리 숫자
  return { qty, amt: amt.toLocaleString() }; // amt는 천 단위 구분자(,) 포함
};

/**
 * 셀 값에 대한 합계 계산 (Qty, Amt에 따라 다르게 처리)
 * @param rows 합계를 계산할 행들
 * @param colIndex 계산할 열 인덱스
 * @param isAmtColumn 금액 열 여부
 * @returns 계산된 합계 (문자열)
 */
export const calculateCellSum = (rows: any[], colIndex: number, isAmtColumn: boolean = false) => {
  const sum = rows.reduce((acc, row) => {
    // 빈 값이나 "2"와 같은 잘못된 값은 0으로 처리
    const value = (row[colIndex] === "2" || !row[colIndex]) ? 0 : row[colIndex];
    return acc + parseNumericValue(value, 0);
  }, 0);
  
  return isAmtColumn ? sum.toLocaleString() : sum.toString();
};

/**
 * 모델 데이터 초기화
 * @param model 모델명
 * @returns 초기화된 모델 행 데이터
 */
export const initializeModelRow = (model: string) => {
  return [model];
};

/**
 * 모델 행에 월별 데이터 추가
 * @param modelRow 모델 행 데이터
 * @param monthCount 월 수
 * @param categoryCount 카테고리 수 (비고 제외)
 */
export const addMonthlyDataToModelRow = (modelRow: any[], monthCount: number, categoryCount: number) => {
  const updatedRow = [...modelRow];
  
  // 월별 데이터 생성
  for (let month = 0; month < monthCount; month++) {
    // 카테고리별 데이터 생성
    for (let category = 0; category < categoryCount; category++) {
      // 모든 월(짝수/홀수)에 대해 일관된 방식으로 랜덤 데이터 생성
      const { qty, amt } = generateRandomData();
      
      // 최소값 보장 (0이나 빈 값 방지)
      const qtyValue = qty < 10 ? 10 : qty;
      const amtValue = parseNumericValue(amt) < 100 ? '100' : amt;
      
      updatedRow.push(qtyValue.toString());
      updatedRow.push(amtValue);
    }
    // 비고 칼럼 추가
    updatedRow.push('');
  }
  
  return updatedRow;
};
